2025-04-01 15:41:16,558 - speechbrain.utils.quirks - INFO - Applied quirks (see `speechbrain.utils.quirks`): [allow_tf32, disable_jit_profiling]
2025-04-01 15:41:16,559 - speechbrain.utils.quirks - INFO - Excluded quirks specified by the `SB_DISABLE_QUIRKS` environment (comma-separated list): []
2025-04-01 15:41:16,559 - speechbrain.core - INFO - Beginning experiment!
2025-04-01 15:41:16,559 - speechbrain.core - INFO - Experiment folder: debugq
2025-04-01 15:41:16,892 - speechbrain.utils.superpowers - DEBUG - absl-py==2.1.0
accelerate==1.2.1
antlr4-python3-runtime==4.9.3
anyio==4.8.0
appdirs==1.4.4
argbind==0.3.9
argon2-cffi==23.1.0
argon2-cffi-bindings==21.2.0
arrow==1.3.0
asttokens==3.0.0
async-lru==2.0.4
attrs==24.3.0
audioread==3.0.1
babel==2.16.0
beartype==0.19.0
beautifulsoup4==4.12.3
bitarray==2.9.2
black==24.3.0
bleach==6.2.0
certifi==2024.2.2
cffi==1.16.0
cfgv==3.4.0
charset-normalizer==3.3.2
click==8.1.7
cloudpickle==3.1.0
colorama==0.4.6
coloredlogs==15.0.1
comm==0.2.2
contourpy==1.2.1
cycler==0.12.1
Cython==3.0.10
debugpy==1.8.11
decorator==5.1.1
defusedxml==0.7.1
descript-audio-codec==1.0.0
descript-audiotools==0.7.2
distlib==0.3.9
dnspython==2.7.0
docstring_parser==0.16
docstring_parser_fork==0.0.10
einops==0.8.0
emcee==3.1.6
emukit==0.4.11
entrypoints==0.3
exceptiongroup==1.2.2
executing==2.1.0
-e git+https://github.com/facebookresearch/fairseq.git@ecbf110e1eb43861214b05fa001eff584954f65a#egg=fairseq
falcon==4.0.2
falcon-cors==1.1.7
fastjsonschema==2.21.1
ffmpy==0.5.0
filelock==3.14.0
fire==0.7.0
flake8==7.0.0
flatbuffers==24.12.23
flatten-dict==0.4.2
fonttools==4.51.0
fqdn==1.5.1
fsspec==2024.3.1
future==1.0.0
gitdb==4.0.12
GitPython==3.1.44
GPy==1.13.2
grpcio==1.69.0
gunicorn==23.0.0
h11==0.14.0
httpcore==1.0.7
httpx==0.28.1
huggingface-hub==0.22.2
humanfriendly==10.0
hydra-core==1.0.7
HyperPyYAML==1.2.2
identify==2.6.5
idna==3.7
importlib_resources==6.4.0
iniconfig==2.0.0
ipykernel==6.29.5
ipython==8.31.0
isoduration==20.11.0
isort==5.13.2
jedi==0.19.2
Jinja2==3.1.3
joblib==1.4.0
json5==0.10.0
jsonlines==4.0.0
jsonpointer==3.0.0
jsonschema==4.23.0
jsonschema-specifications==2024.10.1
julius==0.2.7
jupyter-events==0.11.0
jupyter-lsp==2.2.5
jupyter_client==8.6.3
jupyter_core==5.7.2
jupyter_server==2.15.0
jupyter_server_terminals==0.5.3
jupyterlab==4.3.4
jupyterlab_pygments==0.3.0
jupyterlab_server==2.27.3
kaldiio==2.18.0
kaleido==0.2.1
kiwisolver==1.4.5
lazy_loader==0.4
librosa==0.10.2.post1
lion-pytorch==0.2.3
llvmlite==0.43.0
lxml==5.2.1
Markdown==3.7
markdown-it-py==3.0.0
markdown2==2.5.2
MarkupSafe==2.1.5
matplotlib==3.9.0
matplotlib-inline==0.1.7
mccabe==0.7.0
mdurl==0.1.2
mistune==3.1.0
more-itertools==10.6.0
mpmath==1.3.0
msgpack==1.1.0
mypy-extensions==1.0.0
nbclient==0.10.2
nbconvert==7.16.5
nbformat==5.10.4
nest-asyncio==1.6.0
networkx==3.2.1
nodeenv==1.9.1
notebook==7.3.2
notebook_shim==0.2.4
numba==0.60.0
numpy==1.26.3
nvidia-cublas-cu12==12.1.3.1
nvidia-cuda-cupti-cu12==12.1.105
nvidia-cuda-nvrtc-cu12==12.1.105
nvidia-cuda-runtime-cu12==12.1.105
nvidia-cudnn-cu12==8.9.2.26
nvidia-cufft-cu12==11.0.2.54
nvidia-curand-cu12==10.3.2.106
nvidia-cusolver-cu12==11.4.5.107
nvidia-cusparse-cu12==12.1.0.106
nvidia-nccl-cu12==2.18.1
nvidia-nvjitlink-cu12==12.4.127
nvidia-nvtx-cu12==12.1.105
omegaconf==2.3.0
onnxruntime==1.20.1
orion==0.2.7
overrides==7.7.0
packaging==24.0
pandas==1.5.3
pandocfilters==1.5.1
paramz==0.9.6
parso==0.8.4
pathspec==0.12.1
pexpect==4.9.0
pillow==10.3.0
platformdirs==4.3.6
plotly==5.24.1
pluggy==0.13.1
pooch==1.8.2
portalocker==2.8.2
pre_commit==4.0.1
prometheus_client==0.21.1
prompt_toolkit==3.0.48
protobuf==6.30.1
psutil==6.1.1
ptyprocess==0.7.0
pure_eval==0.2.3
py==1.11.0
pyaml==25.1.0
pyarrow==15.0.0
pybnn==0.0.5
pycodestyle==2.11.0
pycparser==2.22
pydoclint==0.4.1
pyflakes==3.2.0
Pygments==2.19.1
pygtrie==2.5.0
pyloudnorm==0.1.1
pymongo==4.10.1
pyparsing==3.1.2
pystoi==0.4.1
pytest==7.4.0
python-dateutil==2.9.0.post0
python-json-logger==3.2.1
pytz==2024.1
PyYAML==6.0.1
pyzmq==26.2.0
randomname==0.2.1
referencing==0.35.1
regex==2024.4.28
requests==2.31.0
rfc3339-validator==0.1.4
rfc3986-validator==0.1.1
rich==13.9.4
rpds-py==0.22.3
ruamel.yaml==0.18.10
ruamel.yaml.clib==0.2.12
sacrebleu==2.4.2
safetensors==0.4.3
scikit-learn==1.3.2
scikit-optimize==0.10.2
scipy==1.13.0
Send2Trash==1.8.3
sentencepiece==0.2.0
six==1.16.0
smmap==5.0.2
sniffio==1.3.1
soundfile==0.11.0
soupsieve==2.6
soxr==0.5.0.post1
-e git+ssh://git@github.com/ana-kuznetsova/speechbrain.git@015b39d668f5882e60565e8afe4573385aa8eadb#egg=speechbrain
speechtokenizer==1.0.1
stack-data==0.6.3
sympy==1.12
tabulate==0.9.0
tenacity==9.0.0
tensorboard==2.18.0
tensorboard-data-server==0.7.2
tensorboardX==2.6.2.2
termcolor==2.5.0
terminado==0.18.1
tgt==1.5
threadpoolctl==3.5.0
timm==0.9.12
tinycss2==1.4.0
tokenizers==0.21.0
toml==0.10.2
tomli==2.2.1
torch==2.1.2
torch-stoi==0.2.3
torchaudio==2.1.2
torchsummary==1.5.1
torchvision==0.16.2
tornado==6.4.2
tqdm==4.64.1
traitlets==5.14.3
transformers==4.48.0
triton==2.1.0
typed-ast==1.5.5
types-python-dateutil==2.9.0.20241206
typing_extensions==4.11.0
tzdata==2024.1
Unidecode==1.3.8
uri-template==1.3.0
urllib3==2.2.1
virtualenv==20.28.1
wavtokenizer @ git+https://github.com/Tomiinek/WavTokenizer@3b6839a2ca3020181caa39f598313f4967712b19
wcwidth==0.2.13
webcolors==24.11.1
webencodings==0.5.1
websocket-client==1.8.0
Werkzeug==3.1.3
yamllint==1.35.1
youtube-dl==2021.12.17
zipp==3.18.2


2025-04-01 15:41:16,896 - speechbrain.utils.superpowers - DEBUG - 015b39d66


2025-04-01 15:41:16,952 - urbansound8k_prepare - INFO - Creating debugq/save/manifest/train.json, debugq/save/manifest/valid.json, and debugq/save/manifest/test.json
2025-04-01 15:42:30,453 - urbansound8k_prepare - INFO - debugq/save/manifest/train.json successfully created!
2025-04-01 15:42:38,440 - urbansound8k_prepare - INFO - debugq/save/manifest/valid.json successfully created!
2025-04-01 15:42:46,995 - urbansound8k_prepare - INFO - debugq/save/manifest/test.json successfully created!
2025-04-01 15:45:01,848 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint save hook for save
2025-04-01 15:45:01,848 - speechbrain.utils.checkpoints - DEBUG - Registered checkpoint load hook for load_if_possible
2025-04-01 15:45:01,867 - speechbrain.dataio.encoder - DEBUG - Would load categorical encoding from debugq/save/label_encoder.txt, but file doesn't exist yet.
2025-04-01 15:45:01,887 - speechbrain.dataio.encoder - INFO - Load called, but CategoricalEncoder is not empty. Loaded data will overwrite everything. This is normal if there is e.g. an unk label defined at init.
2025-04-01 15:45:01,888 - speechbrain.dataio.encoder - DEBUG - Loaded categorical encoding from debugq/save/label_encoder.txt
2025-04-01 15:45:01,888 - speechbrain.utils.parameter_transfer - DEBUG - Collecting files (or symlinks) for pretraining in debugq/save.
2025-04-01 15:45:01,888 - speechbrain.utils.fetching - DEBUG - Fetch: Local file found, creating symlink '/data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/results/urban_sound_2x/save/CKPT+2025-04-01+13-43-48+00/embedding_model.ckpt' -> '/data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt'
2025-04-01 15:45:01,888 - speechbrain.utils.parameter_transfer - DEBUG - Set local path in self.paths["embedding_model"] = /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt
2025-04-01 15:45:01,888 - speechbrain.utils.fetching - DEBUG - Fetch: Local file found, creating symlink '/data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/results/urban_sound_2x/save/CKPT+2025-04-01+13-43-48+00/classifier.ckpt' -> '/data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/classifier.ckpt'
2025-04-01 15:45:01,888 - speechbrain.utils.parameter_transfer - DEBUG - Set local path in self.paths["classifier"] = /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/classifier.ckpt
2025-04-01 15:45:01,888 - speechbrain.utils.parameter_transfer - INFO - Loading pretrained files for: embedding_model, classifier
2025-04-01 15:45:01,888 - speechbrain.utils.parameter_transfer - DEBUG - Redirecting (loading from local path): embedding_model -> /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt
2025-04-01 15:45:01,888 - speechbrain.utils.parameter_transfer - DEBUG - Redirecting (loading from local path): classifier -> /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/classifier.ckpt
2025-04-01 15:45:01,961 - speechbrain.utils.checkpoints - WARNING - During parameter transfer to ECAPA_TDNNQ(
  (blocks): ModuleList(
    (0): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(80, 1024, kernel_size=(5,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (1): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(2,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (2): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(3,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (3): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(4,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
  )
  (quantizer): ResidualVectorQuantize(
    (quantizers): ModuleList(
      (0): VectorQuantize(
        (in_proj): ParametrizedConv1d(
          1024, 64, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (out_proj): ParametrizedConv1d(
          64, 1024, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (codebook): Embedding(1024, 64)
      )
    )
  )
  (mfa): TDNNBlock(
    (conv): Conv1d(
      (conv): Conv1d(1536, 1536, kernel_size=(1,), stride=(1,))
    )
    (activation): ReLU()
    (norm): BatchNorm1d(
      (norm): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (dropout): Dropout1d(p=0.0, inplace=False)
  )
  (asp): AttentiveStatisticsPooling(
    (tdnn): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(4608, 128, kernel_size=(1,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (tanh): Tanh()
    (conv): Conv1d(
      (conv): Conv1d(128, 1536, kernel_size=(1,), stride=(1,))
    )
  )
  (asp_bn): BatchNorm1d(
    (norm): BatchNorm1d(3072, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (fc): Conv1d(
    (conv): Conv1d(3072, 192, kernel_size=(1,), stride=(1,))
  )
) loading from /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt, the transferred parameters did not have parameters for the key: quantizer.quantizers.0.in_proj.bias
2025-04-01 15:45:01,962 - speechbrain.utils.checkpoints - WARNING - During parameter transfer to ECAPA_TDNNQ(
  (blocks): ModuleList(
    (0): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(80, 1024, kernel_size=(5,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (1): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(2,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (2): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(3,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (3): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(4,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
  )
  (quantizer): ResidualVectorQuantize(
    (quantizers): ModuleList(
      (0): VectorQuantize(
        (in_proj): ParametrizedConv1d(
          1024, 64, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (out_proj): ParametrizedConv1d(
          64, 1024, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (codebook): Embedding(1024, 64)
      )
    )
  )
  (mfa): TDNNBlock(
    (conv): Conv1d(
      (conv): Conv1d(1536, 1536, kernel_size=(1,), stride=(1,))
    )
    (activation): ReLU()
    (norm): BatchNorm1d(
      (norm): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (dropout): Dropout1d(p=0.0, inplace=False)
  )
  (asp): AttentiveStatisticsPooling(
    (tdnn): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(4608, 128, kernel_size=(1,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (tanh): Tanh()
    (conv): Conv1d(
      (conv): Conv1d(128, 1536, kernel_size=(1,), stride=(1,))
    )
  )
  (asp_bn): BatchNorm1d(
    (norm): BatchNorm1d(3072, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (fc): Conv1d(
    (conv): Conv1d(3072, 192, kernel_size=(1,), stride=(1,))
  )
) loading from /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt, the transferred parameters did not have parameters for the key: quantizer.quantizers.0.in_proj.parametrizations.weight.original0
2025-04-01 15:45:01,963 - speechbrain.utils.checkpoints - WARNING - During parameter transfer to ECAPA_TDNNQ(
  (blocks): ModuleList(
    (0): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(80, 1024, kernel_size=(5,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (1): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(2,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (2): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(3,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (3): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(4,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
  )
  (quantizer): ResidualVectorQuantize(
    (quantizers): ModuleList(
      (0): VectorQuantize(
        (in_proj): ParametrizedConv1d(
          1024, 64, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (out_proj): ParametrizedConv1d(
          64, 1024, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (codebook): Embedding(1024, 64)
      )
    )
  )
  (mfa): TDNNBlock(
    (conv): Conv1d(
      (conv): Conv1d(1536, 1536, kernel_size=(1,), stride=(1,))
    )
    (activation): ReLU()
    (norm): BatchNorm1d(
      (norm): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (dropout): Dropout1d(p=0.0, inplace=False)
  )
  (asp): AttentiveStatisticsPooling(
    (tdnn): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(4608, 128, kernel_size=(1,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (tanh): Tanh()
    (conv): Conv1d(
      (conv): Conv1d(128, 1536, kernel_size=(1,), stride=(1,))
    )
  )
  (asp_bn): BatchNorm1d(
    (norm): BatchNorm1d(3072, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (fc): Conv1d(
    (conv): Conv1d(3072, 192, kernel_size=(1,), stride=(1,))
  )
) loading from /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt, the transferred parameters did not have parameters for the key: quantizer.quantizers.0.in_proj.parametrizations.weight.original1
2025-04-01 15:45:01,964 - speechbrain.utils.checkpoints - WARNING - During parameter transfer to ECAPA_TDNNQ(
  (blocks): ModuleList(
    (0): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(80, 1024, kernel_size=(5,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (1): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(2,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (2): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(3,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (3): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(4,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
  )
  (quantizer): ResidualVectorQuantize(
    (quantizers): ModuleList(
      (0): VectorQuantize(
        (in_proj): ParametrizedConv1d(
          1024, 64, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (out_proj): ParametrizedConv1d(
          64, 1024, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (codebook): Embedding(1024, 64)
      )
    )
  )
  (mfa): TDNNBlock(
    (conv): Conv1d(
      (conv): Conv1d(1536, 1536, kernel_size=(1,), stride=(1,))
    )
    (activation): ReLU()
    (norm): BatchNorm1d(
      (norm): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (dropout): Dropout1d(p=0.0, inplace=False)
  )
  (asp): AttentiveStatisticsPooling(
    (tdnn): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(4608, 128, kernel_size=(1,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (tanh): Tanh()
    (conv): Conv1d(
      (conv): Conv1d(128, 1536, kernel_size=(1,), stride=(1,))
    )
  )
  (asp_bn): BatchNorm1d(
    (norm): BatchNorm1d(3072, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (fc): Conv1d(
    (conv): Conv1d(3072, 192, kernel_size=(1,), stride=(1,))
  )
) loading from /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt, the transferred parameters did not have parameters for the key: quantizer.quantizers.0.out_proj.bias
2025-04-01 15:45:01,966 - speechbrain.utils.checkpoints - WARNING - During parameter transfer to ECAPA_TDNNQ(
  (blocks): ModuleList(
    (0): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(80, 1024, kernel_size=(5,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (1): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(2,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (2): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(3,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (3): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(4,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
  )
  (quantizer): ResidualVectorQuantize(
    (quantizers): ModuleList(
      (0): VectorQuantize(
        (in_proj): ParametrizedConv1d(
          1024, 64, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (out_proj): ParametrizedConv1d(
          64, 1024, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (codebook): Embedding(1024, 64)
      )
    )
  )
  (mfa): TDNNBlock(
    (conv): Conv1d(
      (conv): Conv1d(1536, 1536, kernel_size=(1,), stride=(1,))
    )
    (activation): ReLU()
    (norm): BatchNorm1d(
      (norm): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (dropout): Dropout1d(p=0.0, inplace=False)
  )
  (asp): AttentiveStatisticsPooling(
    (tdnn): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(4608, 128, kernel_size=(1,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (tanh): Tanh()
    (conv): Conv1d(
      (conv): Conv1d(128, 1536, kernel_size=(1,), stride=(1,))
    )
  )
  (asp_bn): BatchNorm1d(
    (norm): BatchNorm1d(3072, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (fc): Conv1d(
    (conv): Conv1d(3072, 192, kernel_size=(1,), stride=(1,))
  )
) loading from /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt, the transferred parameters did not have parameters for the key: quantizer.quantizers.0.out_proj.parametrizations.weight.original0
2025-04-01 15:45:01,967 - speechbrain.utils.checkpoints - WARNING - During parameter transfer to ECAPA_TDNNQ(
  (blocks): ModuleList(
    (0): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(80, 1024, kernel_size=(5,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (1): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(2,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (2): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(3,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (3): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(4,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
  )
  (quantizer): ResidualVectorQuantize(
    (quantizers): ModuleList(
      (0): VectorQuantize(
        (in_proj): ParametrizedConv1d(
          1024, 64, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (out_proj): ParametrizedConv1d(
          64, 1024, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (codebook): Embedding(1024, 64)
      )
    )
  )
  (mfa): TDNNBlock(
    (conv): Conv1d(
      (conv): Conv1d(1536, 1536, kernel_size=(1,), stride=(1,))
    )
    (activation): ReLU()
    (norm): BatchNorm1d(
      (norm): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (dropout): Dropout1d(p=0.0, inplace=False)
  )
  (asp): AttentiveStatisticsPooling(
    (tdnn): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(4608, 128, kernel_size=(1,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (tanh): Tanh()
    (conv): Conv1d(
      (conv): Conv1d(128, 1536, kernel_size=(1,), stride=(1,))
    )
  )
  (asp_bn): BatchNorm1d(
    (norm): BatchNorm1d(3072, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (fc): Conv1d(
    (conv): Conv1d(3072, 192, kernel_size=(1,), stride=(1,))
  )
) loading from /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt, the transferred parameters did not have parameters for the key: quantizer.quantizers.0.out_proj.parametrizations.weight.original1
2025-04-01 15:45:01,968 - speechbrain.utils.checkpoints - WARNING - During parameter transfer to ECAPA_TDNNQ(
  (blocks): ModuleList(
    (0): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(80, 1024, kernel_size=(5,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (1): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(2,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (2): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(3,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
    (3): SERes2NetBlock(
      (tdnn1): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (res2net_block): Res2NetBlock(
        (blocks): ModuleList(
          (0-6): 7 x TDNNBlock(
            (conv): Conv1d(
              (conv): Conv1d(128, 128, kernel_size=(3,), stride=(1,), dilation=(4,))
            )
            (activation): ReLU()
            (norm): BatchNorm1d(
              (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            )
            (dropout): Dropout1d(p=0.0, inplace=False)
          )
        )
      )
      (tdnn2): TDNNBlock(
        (conv): Conv1d(
          (conv): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
        )
        (activation): ReLU()
        (norm): BatchNorm1d(
          (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (dropout): Dropout1d(p=0.0, inplace=False)
      )
      (se_block): SEBlock(
        (conv1): Conv1d(
          (conv): Conv1d(1024, 128, kernel_size=(1,), stride=(1,))
        )
        (relu): ReLU(inplace=True)
        (conv2): Conv1d(
          (conv): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
        )
        (sigmoid): Sigmoid()
      )
    )
  )
  (quantizer): ResidualVectorQuantize(
    (quantizers): ModuleList(
      (0): VectorQuantize(
        (in_proj): ParametrizedConv1d(
          1024, 64, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (out_proj): ParametrizedConv1d(
          64, 1024, kernel_size=(1,), stride=(1,)
          (parametrizations): ModuleDict(
            (weight): ParametrizationList(
              (0): _WeightNorm()
            )
          )
        )
        (codebook): Embedding(1024, 64)
      )
    )
  )
  (mfa): TDNNBlock(
    (conv): Conv1d(
      (conv): Conv1d(1536, 1536, kernel_size=(1,), stride=(1,))
    )
    (activation): ReLU()
    (norm): BatchNorm1d(
      (norm): BatchNorm1d(1536, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (dropout): Dropout1d(p=0.0, inplace=False)
  )
  (asp): AttentiveStatisticsPooling(
    (tdnn): TDNNBlock(
      (conv): Conv1d(
        (conv): Conv1d(4608, 128, kernel_size=(1,), stride=(1,))
      )
      (activation): ReLU()
      (norm): BatchNorm1d(
        (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (dropout): Dropout1d(p=0.0, inplace=False)
    )
    (tanh): Tanh()
    (conv): Conv1d(
      (conv): Conv1d(128, 1536, kernel_size=(1,), stride=(1,))
    )
  )
  (asp_bn): BatchNorm1d(
    (norm): BatchNorm1d(3072, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (fc): Conv1d(
    (conv): Conv1d(3072, 192, kernel_size=(1,), stride=(1,))
  )
) loading from /data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/debugq/save/embedding_model.ckpt, the transferred parameters did not have parameters for the key: quantizer.quantizers.0.codebook.weight
2025-04-01 15:45:01,968 - speechbrain.core - INFO - Info: ckpt_interval_minutes arg from hparam file is used
2025-04-01 15:45:02,258 - speechbrain.core - INFO - Gradscaler enabled: False. Using precision: fp32.
2025-04-01 15:45:02,258 - speechbrain.core - INFO - UrbanSound8kBrain Model Statistics:
* Total Number of Trainable Parameters: 12.5M
* Total Number of Parameters: 12.5M
* Trainable Parameters represent 100.0000% of the total size.
2025-04-01 15:45:02,260 - speechbrain.utils.checkpoints - INFO - Would load a checkpoint here, but none found yet.
2025-04-01 15:45:02,260 - speechbrain.utils.epoch_loop - INFO - Going into epoch 1
2025-04-01 15:45:02,342 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 10 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-01 15:45:02,355 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 10 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-01 15:45:02,355 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 10 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-01 15:45:02,359 - speechbrain.dataio.encoder - WARNING - CategoricalEncoder.expect_len was never called: assuming category count of 10 to be correct! Sanity check your encoder using `.expect_len`. Ensure that downstream code also uses the correct size. If you are sure this does not apply to you, use `.ignore_len`.
2025-04-01 15:45:15,882 - speechbrain.core - ERROR - Exception:
Traceback (most recent call last):
  File "/data/anakuzne/speechbrain/recipes/UrbanSound8k/SoundClassification/ecapa_tdnn/train.py", line 434, in <module>
    urban_sound_8k_brain.fit(
  File "/data/anakuzne/speechbrain/speechbrain/core.py", line 1621, in fit
    self._fit_train(train_set=train_set, epoch=epoch, enable=enable)
  File "/data/anakuzne/speechbrain/speechbrain/core.py", line 1446, in _fit_train
    loss = self.fit_batch(batch)
  File "/data/anakuzne/speechbrain/speechbrain/core.py", line 1250, in fit_batch
    return loss.detach().cpu()
KeyboardInterrupt
